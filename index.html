<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>生字配对游戏（甜美动画版）</title>
<style>
  body {
    font-family: 'Microsoft YaHei', sans-serif;
    margin: 0;
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #d81b60;
    background: linear-gradient(rgba(255,255,255,0.5), rgba(255,255,255,0.5)),
                url('https://cdn.pixabay.com/photo/2017/08/30/00/18/background-2694032_1280.png') no-repeat center center;
    background-size: cover;
    transition: background 0.5s ease;
    overflow-x: hidden;
  }

  h1 { text-align: center; margin-top: 0; }
  .score { font-size: 1.2rem; margin-top: 10px; color: #d81b60; z-index: 1; }
  .game-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    width: 90%;
    max-width: 500px;
    margin-top: 20px;
    z-index: 1;
  }
  .row {
    display: flex;
    justify-content: space-between;
    gap: 10px;
  }
  .word, .pair-box {
    flex: 1;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    border-radius: 15px;
    text-align: center;
    box-shadow: 2px 2px 8px rgba(0,0,0,0.2);
    z-index: 1;
    transition: transform 0.3s ease;
  }
  .word {
    background: #ffd1e8;
    border: 2px solid #d81b60;
    cursor: grab;
  }
  .word:active { transform: scale(1.1) rotate(-2deg); }

  .pair-box {
    border: 2px dashed #f48fb1;
    background: #ffe4f1;
    color: #000;
    position: relative;
  }

  /* 动画效果 */
  .pair-box.flash { animation: flash 0.6s ease; }
  .pair-box.correct {
    background-color: #d81b60;
    color: #fff;
    border: 2px solid #880e4f;
    animation: jump 0.5s;
  }
  .pair-box.wrong {
    background-color: #f44336;
    color: #fff;
    border: 2px solid #b71c1c;
    animation: shake 0.5s;
  }

  @keyframes flash {
    0% { box-shadow: 0 0 0px #fff; }
    50% { box-shadow: 0 0 20px 10px #f48fb1; }
    100% { box-shadow: 0 0 0px #fff; }
  }
  @keyframes jump {
    0% { transform: translateY(0); }
    30% { transform: translateY(-15px); }
    60% { transform: translateY(0); }
    100% { transform: translateY(-5px); }
  }
  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    50% { transform: translateX(8px); }
    75% { transform: translateX(-8px); }
    100% { transform: translateX(0); }
  }

  button {
    margin-top: 15px;
    padding: 10px 25px;
    border: none;
    border-radius: 12px;
    background-color: #d81b60;
    color: #fff;
    cursor: pointer;
    font-size: 1rem;
  }
</style>
</head>
<body>
<h1>生字配对成词语游戏</h1>
<p>左边生字固定顺序，右边目标框随机排列。拖动正确显示绿色并跳跃动画，错误闪红抖动回原位。</p>
<div class="score" id="score">完成：0 / 6</div>
<div class="game-container" id="gameContainer"></div>
<div>
  <button id="prevBtn" onclick="prevPage()" disabled>上一页</button>
  <button id="nextBtn" onclick="nextPage()">下一页</button>
  <button onclick="resetGame()">重置</button>
</div>

<script>
const allData = [
  {word: '故', pair: '事'}, 
  {word: '练', pair: '习'}, 
  {word: '朋', pair: '友'}, 
  {word: '长', pair: '尺'}, 
  {word: '知', pair: '识'}, 
  {word: '不', pair: '会'}, 
  {word: '出', pair: '去'}, 
  {word: '课', pair: '室'}, 
  {word: '操', pair: '场'}, 
  {word: '回', pair: '家'}, 
  {word: '跳', pair: '高'}, 
  {word: '招', pair: '手'}
];

const pageBackgrounds = [
  'https://cdn.wallpapersafari.com/15/33/QxTK2b.jpg',
  'https://cdn.wallpapersafari.com/15/33/QxTK2b.jpg'
];

let currentPage = 0;
const pageSize = 6;
let score = 0;

function shuffle(arr) {
  const array = [...arr];
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function renderPage() {
  const container = document.getElementById('gameContainer');
  container.innerHTML = '';
  score = 0;
  updateScore();

  // 设置背景图片
  document.body.style.background = `linear-gradient(rgba(255,255,255,0.5), rgba(255,255,255,0.5)), 
                                    url(${pageBackgrounds[currentPage]}) no-repeat center center`;
  document.body.style.backgroundSize = 'cover';

  const start = currentPage * pageSize;
  const end = Math.min(start + pageSize, allData.length);
  const pageData = allData.slice(start, end);

  for (let i = 0; i < pageData.length; i++) {
    const row = document.createElement('div');
    row.className = 'row';

    const wordDiv = document.createElement('div');
    wordDiv.className = 'word';
    wordDiv.textContent = pageData[i].word;
    wordDiv.draggable = true;
    wordDiv.id = 'word-' + i;
    wordDiv.ondragstart = drag;
    row.appendChild(wordDiv);

    container.appendChild(row);
  }

  const targets = shuffle(pageData);
  const rows = container.querySelectorAll('.row');
  for (let i = 0; i < targets.length; i++) {
    const targetDiv = document.createElement('div');
    targetDiv.className = 'pair-box';
    targetDiv.dataset.word = targets[i].word;
    targetDiv.dataset.pair = targets[i].pair;
    targetDiv.dataset.full = targets[i].word + targets[i].pair;
    targetDiv.textContent = targets[i].pair;
    targetDiv.ondragover = allowDrop;
    targetDiv.ondrop = drop;

    rows[i].appendChild(targetDiv);
  }

  document.getElementById('prevBtn').disabled = currentPage === 0;
  document.getElementById('nextBtn').disabled = end >= allData.length;
}

function allowDrop(e) { e.preventDefault(); }
function drag(e) { e.dataTransfer.setData('text', e.target.id); }

function drop(e) {
  e.preventDefault();
  const dataId = e.dataTransfer.getData('text');
  const dragged = document.getElementById(dataId);
  const box = e.currentTarget;

  if (!dragged) return;
  if (box.querySelector('.word')) return;

  if (dragged.textContent === box.dataset.word) {
    box.textContent = box.dataset.full;
    box.classList.add('correct', 'flash');
    dragged.draggable = false;
    dragged.style.display = 'none';
    speakWord(box.dataset.full);
    score++;
    setTimeout(() => box.classList.remove('flash'), 600);
  } else {
    box.classList.add('wrong', 'flash');
    setTimeout(() => {
      box.classList.remove('wrong', 'flash');
    }, 600);
  }
  updateScore();
}

function updateScore() {
  const pageEnd = Math.min(pageSize, allData.length - currentPage * pageSize);
  document.getElementById('score').textContent = `完成：${score} / ${pageEnd}`;
}

function nextPage() {
  if ((currentPage + 1) * pageSize < allData.length) {
    currentPage++;
    renderPage();
  }
}

function prevPage() {
  if (currentPage > 0) {
    currentPage--;
    renderPage();
  }
}

function resetGame() {
  renderPage();
}

function speakWord(word) {
  try {
    const utter = new SpeechSynthesisUtterance(word);
    utter.lang = 'zh-CN';
    window.speechSynthesis.speak(utter);
  } catch(e) { console.warn('语音播放失败', e); }
}

renderPage();
</script>
</body>
</html>
